import torch
from torch import nn
embed_dim=4
bias=False
q_proj = nn.Linear(embed_dim, embed_dim, bias=bias)
q_proj = torch.Tensor([[0,0,0,1000]]*4)
tgt_len=10
batch_size = 2

query = torch.randn(tgt_len,batch_size,embed_dim)

q = q_proj(query)
#tgt_len X batch_size, embed_size]
    #q_proj.weight.data.multiply(vector)+bias
'''
>>> query
tensor([[[ 0.3514,  0.6784, -0.2468, -0.0744],
         [-0.5749, -1.0856,  0.1899, -0.6495]],

        [[ 0.3886,  1.0415, -2.6476, -0.6007],
         [-0.5206, -0.2409, -2.0189,  1.2781]],

        [[-0.7151, -0.4468, -0.5643,  2.5008],
         [ 0.5548,  0.5749,  0.7156,  1.4539]],

        [[ 0.9893,  2.1110,  0.0728,  1.3039],
         [-0.7849,  0.7965, -0.3072,  0.0438]],

        [[-1.8601, -1.6426, -1.0290, -0.6261],
         [ 0.0521, -0.4572,  0.5344, -1.0841]],

        [[-1.4737,  0.4897, -1.1495,  1.4010],
         [ 0.5985,  0.5766,  1.4295, -0.8411]],

        [[ 0.4730,  0.8477, -0.3121, -0.0974],
         [ 0.5048,  0.4847, -0.5261, -0.5850]],

        [[-0.0794,  0.3429, -0.3275, -0.3575],
         [ 0.1718, -0.1938,  2.3895, -1.0838]],

        [[ 2.1581,  0.8903,  1.4802, -1.7233],
         [ 1.2449,  0.2688, -0.2827, -0.0209]],

        [[ 0.6119,  0.5332,  0.7703,  1.2138],
         [ 0.5706,  1.8670, -1.1782,  0.9187]]])

 >>> q
tensor([[[  -744.4467,   -744.4467,   -744.4467,   -744.4467],
         [ -6495.2305,  -6495.2305,  -6495.2305,  -6495.2305]],

        [[ -6007.4307,  -6007.4307,  -6007.4307,  -6007.4307],
         [ 12780.8906,  12780.8906,  12780.8906,  12780.8906]],

        [[ 25007.9473,  25007.9473,  25007.9473,  25007.9473],
         [ 14539.0596,  14539.0596,  14539.0596,  14539.0596]],

        [[ 13039.3809,  13039.3809,  13039.3809,  13039.3809],
         [   438.0122,    438.0122,    438.0122,    438.0122]],

        [[ -6261.2188,  -6261.2188,  -6261.2188,  -6261.2188],
         [-10840.9355, -10840.9355, -10840.9355, -10840.9355]],

        [[ 14009.6436,  14009.6436,  14009.6436,  14009.6436],
         [ -8410.7080,  -8410.7080,  -8410.7080,  -8410.7080]],

        [[  -973.8263,   -973.8263,   -973.8263,   -973.8263],
         [ -5850.4473,  -5850.4473,  -5850.4473,  -5850.4473]],

        [[ -3574.8464,  -3574.8464,  -3574.8464,  -3574.8464],
         [-10838.3984, -10838.3984, -10838.3984, -10838.3984]],

        [[-17232.8926, -17232.8926, -17232.8926, -17232.8926],
         [  -208.9096,   -208.9096,   -208.9096,   -208.9096]],

        [[ 12138.4023,  12138.4023,  12138.4023,  12138.4023],
         [  9186.6289,   9186.6289,   9186.6289,   9186.6289]]],
       grad_fn=<AddBackward0>)
'''